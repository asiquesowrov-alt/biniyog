<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Biniyog | Investment Plan</title>

<style>
body{margin:0;font-family:Arial;background:#fdecec}
.header{padding:16px;text-align:center;font-size:22px;font-weight:bold}
.plan{
 background:#b23a1e;color:#fff;margin:15px;
 border-radius:18px;padding:20px;text-align:center
}
.plan h3{margin:5px 0}
.plan p{margin:4px 0;font-size:15px}
.buy{
 margin-top:12px;background:#facc15;border:none;
 padding:10px 26px;border-radius:20px;
 font-weight:bold;cursor:pointer
}
.buy:disabled{opacity:.6}
</style>
</head>

<body>

<div class="header">‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßç‡¶≤‡¶æ‡¶®</div>

<div class="plan">
<h3>‡¶Æ‡¶ø‡¶®‡¶ø ‡¶™‡ßç‡¶≤‡¶æ‡¶®</h3>
<p>‡ß≥500</p>
<p>‡ß®‡ß™‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡ßü ‡¶Ü‡ßü ‡ß≥90</p>
<p>‡¶Æ‡ßá‡ßü‡¶æ‡¶¶: ‡ßß‡ß¶ ‡¶¶‡¶ø‡¶®</p>
<button class="buy" data-name="Mini" data-price="500" data-daily="90" data-days="10">‡¶ï‡¶ø‡¶®‡ßÅ‡¶®</button>
</div>

<div class="plan">
<h3>‡¶â‡¶á‡¶°‡¶Æ‡¶ø‡¶≤ ‡¶™‡ßç‡¶≤‡¶æ‡¶®</h3>
<p>‡ß≥1000</p>
<p>‡ß®‡ß™‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡ßü ‡¶Ü‡ßü ‡ß≥197</p>
<p>‡¶Æ‡ßá‡ßü‡¶æ‡¶¶: ‡ßß‡ß¶ ‡¶¶‡¶ø‡¶®</p>
<button class="buy" data-name="Windmill" data-price="1000" data-daily="197" data-days="10">‡¶ï‡¶ø‡¶®‡ßÅ‡¶®</button>
</div>

<div class="plan">
<h3>‡¶∂‡ßá‡ßü‡¶æ‡¶∞ ‡¶™‡ßç‡¶≤‡¶æ‡¶®</h3>
<p>‡ß≥2000</p>
<p>‡ß®‡ß™‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡ßü ‡¶Ü‡ßü ‡ß≥470</p>
<p>‡¶Æ‡ßá‡ßü‡¶æ‡¶¶: ‡ßß‡ß¶ ‡¶¶‡¶ø‡¶®</p>
<button class="buy" data-name="Share-2000" data-price="2000" data-daily="470" data-days="10">‡¶ï‡¶ø‡¶®‡ßÅ‡¶®</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth,onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import {
 getFirestore,doc,getDoc,updateDoc,
 addDoc,collection,serverTimestamp
} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

window.addEventListener("DOMContentLoaded",()=>{

 const app=initializeApp({
  apiKey:"AIzaSyBFsTzlRPoWHVXEHbKrPdwxslxZGa7Kqfw",
  authDomain:"biniyog-95d00.firebaseapp.com",
  projectId:"biniyog-95d00"
 });

 const auth=getAuth(app);
 const db=getFirestore(app);

 let uid=null;
 const buttons=document.querySelectorAll(".buy");
 buttons.forEach(b=>b.disabled=true);

 onAuthStateChanged(auth,user=>{
  if(!user){
   location.href="index.html";
  }else{
   uid=user.uid;
   buttons.forEach(b=>b.disabled=false);
  }
 });

 buttons.forEach(btn=>{
  btn.addEventListener("click",()=>buyPlan(btn));
 });

 async function buyPlan(btn){
  if(!uid) return alert("‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá, ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®");

  const planName=btn.dataset.name;
  const price=Number(btn.dataset.price);
  const daily=Number(btn.dataset.daily);
  const days=Number(btn.dataset.days);

  const uref=doc(db,"users",uid);
  const snap=await getDoc(uref);
  const balance=snap.data().balance||0;

  if(balance<price) return alert("‚ùå ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶™‡ßç‡¶§ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶®‡ßá‡¶á");

  await updateDoc(uref,{balance:balance-price});

  await addDoc(collection(db,"user_plans"),{
   uid,planName,price,daily,days,
   totalEarn:daily*days,
   earned:0,
   startAt:serverTimestamp(),
   endAt:Date.now()+days*86400000,
   status:"running"
  });

  alert("‚úÖ ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶® ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡ßá‡¶®‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá\nüì¶ Task ‡¶¨‡¶ï‡ßç‡¶∏ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®");
  location.href="task.html";
 }
});
</script>

</body>
</html>
